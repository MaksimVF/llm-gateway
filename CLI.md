# CLI-—É—Ç–∏–ª–∏—Ç–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è API-–∫–ª—é—á–∞–º–∏

CLI-—É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è API-–∫–ª—é—á–∞–º–∏ –∏ —Ç–∞—Ä–∏—Ñ–∞–º–∏ –≤ LLM Gateway.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

```bash
# –ò–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
cd tools
python cli.py [–∫–æ–º–∞–Ω–¥–∞] [–ø–∞—Ä–∞–º–µ—Ç—Ä—ã]
```

## –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### 1. –°–æ–∑–¥–∞–Ω–∏–µ API-–∫–ª—é—á–∞

```bash
python cli.py create-key --limit 100000 [--name "Plan Name"] [--description "Description"] [--add-to-env]
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `--limit` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –ª–∏–º–∏—Ç —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –∫–ª—é—á–∞
- `--name` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π) - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–∞
- `--description` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π) - –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–∞
- `--add-to-env` (—Ñ–ª–∞–≥) - –¥–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á –≤ .env —Ñ–∞–π–ª

**–ü—Ä–∏–º–µ—Ä:**
```bash
python cli.py create-key --limit 100000 --name "Premium Plan" --description "–ü—Ä–µ–º–∏—É–º —Ç–∞—Ä–∏—Ñ –¥–ª—è VIP –∫–ª–∏–µ–Ω—Ç–æ–≤"
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ API-–∫–ª—é—á —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω:
   –ö–ª—é—á: sk-CjCsdZ0ZyvPgMM1HMzCQajwWevGciqZsQfebOo9w184GKQit
   –õ–∏–º–∏—Ç —Ç–æ–∫–µ–Ω–æ–≤: 100,000
   –ù–∞–∑–≤–∞–Ω–∏–µ: Premium Plan
```

### 2. –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∫–ª—é—á–µ–π

```bash
python cli.py list-keys [--stats] [--verbose]
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `--stats` (—Ñ–ª–∞–≥) - –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
- `--verbose` (—Ñ–ª–∞–≥) - –ø–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥ —Å –æ–ø–∏—Å–∞–Ω–∏—è–º–∏

**–ü—Ä–∏–º–µ—Ä:**
```bash
python cli.py list-keys --stats --verbose
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
üìã –°–ø–∏—Å–æ–∫ API-–∫–ª—é—á–µ–π (4 —à—Ç.):
================================================================================
üîë sk-prod-key-123
   üìä –õ–∏–º–∏—Ç: 1,000,000 —Ç–æ–∫–µ–Ω–æ–≤
   üè∑Ô∏è  –ù–∞–∑–≤–∞–Ω–∏–µ: Production Premium
   üìù –û–ø–∏—Å–∞–Ω–∏–µ: –ü—Ä–µ–º–∏—É–º —Ç–∞—Ä–∏—Ñ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
   –í—Å–µ–≥–æ –∫–ª—é—á–µ–π: 4
   –û–±—â–∏–π –ª–∏–º–∏—Ç: 1,115,000 —Ç–æ–∫–µ–Ω–æ–≤
   –°—Ä–µ–¥–Ω–∏–π –ª–∏–º–∏—Ç: 278,750 —Ç–æ–∫–µ–Ω–æ–≤
   –ú–∏–Ω. –ª–∏–º–∏—Ç: 5,000 —Ç–æ–∫–µ–Ω–æ–≤
   –ú–∞–∫—Å. –ª–∏–º–∏—Ç: 1,000,000 —Ç–æ–∫–µ–Ω–æ–≤
```

### 3. –£–¥–∞–ª–µ–Ω–∏–µ API-–∫–ª—é—á–∞

```bash
python cli.py revoke-key --key sk-abc123... [--force]
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `--key` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - API-–∫–ª—é—á –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
- `--force` (—Ñ–ª–∞–≥) - —É–¥–∞–ª–∏—Ç—å –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä:**
```bash
python cli.py revoke-key --key sk-test-key-1
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚ö†Ô∏è  –í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∫–ª—é—á sk-test-key-...ey-1?
   –õ–∏–º–∏—Ç: 10,000 —Ç–æ–∫–µ–Ω–æ–≤
   –ù–∞–∑–≤–∞–Ω–∏–µ: Test Basic
–í–≤–µ–¥–∏—Ç–µ 'yes' –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: yes
‚úÖ API-–∫–ª—é—á sk-test-key-...ey-1 —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω
```

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞ —Ç–æ–∫–µ–Ω–æ–≤

```bash
python cli.py set-limit --key sk-abc123... --limit 200000
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `--key` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - API-–∫–ª—é—á
- `--limit` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –Ω–æ–≤—ã–π –ª–∏–º–∏—Ç —Ç–æ–∫–µ–Ω–æ–≤

**–ü—Ä–∏–º–µ—Ä:**
```bash
python cli.py set-limit --key sk-test-key-2 --limit 15000
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ –õ–∏–º–∏—Ç —Ç–æ–∫–µ–Ω–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –∫–ª—é—á–∞ sk-test-key-...ey-2
   –°—Ç–∞—Ä—ã–π –ª–∏–º–∏—Ç: 5,000 —Ç–æ–∫–µ–Ω–æ–≤
   –ù–æ–≤—ã–π –ª–∏–º–∏—Ç: 15,000 —Ç–æ–∫–µ–Ω–æ–≤
   –ò–∑–º–µ–Ω–µ–Ω–∏–µ: +200.0%
```

### 5. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

```bash
python cli.py stats
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ API-–∫–ª—é—á–µ–π:
========================================
üìù –í—Å–µ–≥–æ –∫–ª—é—á–µ–π: 4
üéØ –û–±—â–∏–π –ª–∏–º–∏—Ç: 1,125,000 —Ç–æ–∫–µ–Ω–æ–≤
üìä –°—Ä–µ–¥–Ω–∏–π –ª–∏–º–∏—Ç: 281,250 —Ç–æ–∫–µ–Ω–æ–≤
üìâ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ª–∏–º–∏—Ç: 10,000 —Ç–æ–∫–µ–Ω–æ–≤
üìà –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ª–∏–º–∏—Ç: 1,000,000 —Ç–æ–∫–µ–Ω–æ–≤

üè∑Ô∏è  –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ç–∞—Ä–∏—Ñ–∞–º:
   Production Premium: 1 –∫–ª—é—á(–µ–π)
   Premium Plan: 1 –∫–ª—é—á(–µ–π)
   Test Basic: 1 –∫–ª—é—á(–µ–π)
   Test Limited: 1 –∫–ª—é—á(–µ–π)
```

### 6. –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
python cli.py backup [--path backup.json]
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `--path` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π) - –ø—É—Ç—å –¥–ª—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏

**–ü—Ä–∏–º–µ—Ä:**
```bash
python cli.py backup --path my_backup.json
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Å–æ–∑–¥–∞–Ω–∞: my_backup.json
   –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –∫–ª—é—á–µ–π: 4
   –û–±—â–∏–π –ª–∏–º–∏—Ç: 1,125,000 —Ç–æ–∫–µ–Ω–æ–≤
```

### 7. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏

```bash
python cli.py restore --path backup.json [--force]
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `--path` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –ø—É—Ç—å –∫ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
- `--force` (—Ñ–ª–∞–≥) - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä:**
```bash
python cli.py restore --path my_backup.json
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚ö†Ô∏è  –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–º–µ–Ω–∏—Ç —Ç–µ–∫—É—â–∏–µ –∫–ª—é—á–∏!
   –¢–µ–∫—É—â–∏—Ö –∫–ª—é—á–µ–π: 4
   –§–∞–π–ª —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏: my_backup.json
–í–≤–µ–¥–∏—Ç–µ 'yes' –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: yes
‚úÖ –ö–ª—é—á–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∏–∑: my_backup.json
   –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∫–ª—é—á–µ–π: 4
   –û–±—â–∏–π –ª–∏–º–∏—Ç: 1,125,000 —Ç–æ–∫–µ–Ω–æ–≤
```

## –§–æ—Ä–º–∞—Ç—ã API-–∫–ª—é—á–µ–π

CLI –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã –∫–ª—é—á–µ–π:

1. **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–ª—é—á–∏**: `sk-` + 48 —Å–∏–º–≤–æ–ª–æ–≤ (–±—É–∫–≤—ã –∏ —Ü–∏—Ñ—Ä—ã)
   - –ü—Ä–∏–º–µ—Ä: `sk-CjCsdZ0ZyvPgMM1HMzCQajwWevGciqZsQfebOo9w184GKQit`

2. **–¢–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏**: `sk-test-*`, `sk-prod-*`, `sk-demo-*`
   - –ü—Ä–∏–º–µ—Ä—ã: `sk-test-key-1`, `sk-prod-key-123`, `sk-demo-basic`

## –§–∞–π–ª—ã –¥–∞–Ω–Ω—ã—Ö

- **`billing/keys.json`** - –æ—Å–Ω–æ–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ API-–∫–ª—é—á–µ–π –∏ —Ç–∞—Ä–∏—Ñ–æ–≤
- **`keys_backup.json`** - —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

```json
{
  "sk-test-key-1": {
    "max_tokens": 10000,
    "name": "Test Basic",
    "description": "–ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π —Ç–∞—Ä–∏—Ñ",
    "created_at": "2025-06-13T10:30:00"
  }
}
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å .env

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª—é—á–∞ —Å —Ñ–ª–∞–≥–æ–º `--add-to-env`, –∫–ª—é—á –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `ALLOWED_API_KEYS` –≤ —Ñ–∞–π–ª–µ `.env`.

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ö–ª—é—á–∏ –º–∞—Å–∫–∏—Ä—É—é—Ç—Å—è –≤ –≤—ã–≤–æ–¥–µ (–ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 12 –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 4 —Å–∏–º–≤–æ–ª–∞)
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (—É–¥–∞–ª–µ–Ω–∏–µ, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ)
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ –∫–ª—é—á–µ–π –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫–∏

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏
python cli.py create-key --limit 10000 --name "Test Basic"
python cli.py create-key --limit 50000 --name "Test Premium"
python cli.py create-key --limit 100000 --name "Test Enterprise"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
python cli.py stats
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–∫—à–Ω –∫–ª—é—á–∞–º–∏
```bash
# –°–æ–∑–¥–∞–µ–º –ø—Ä–æ–¥–∞–∫—à–Ω –∫–ª—é—á
python cli.py create-key --limit 1000000 --name "Production" --add-to-env

# –°–æ–∑–¥–∞–µ–º —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
python cli.py backup --path prod_backup.json

# –û–±–Ω–æ–≤–ª—è–µ–º –ª–∏–º–∏—Ç
python cli.py set-limit --key sk-abc123... --limit 2000000
```

### –ú–∏–≥—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π
```bash
# –°–æ–∑–¥–∞–µ–º —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é —Ç–µ–∫—É—â–∏—Ö –∫–ª—é—á–µ–π
python cli.py backup --path old_keys.json

# –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∑ –¥—Ä—É–≥–æ–π —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
python cli.py restore --path new_keys.json --force
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞
```
‚ùå –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞: No module named 'key_utils'
```
**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–ø—É—Å–∫–∞–π—Ç–µ CLI –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `tools/`

### –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∫–ª—é—á–∞
```
‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∫–ª—é—á–∞: invalid-key
```
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª—é—á–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `sk-*`

### –ö–ª—é—á –Ω–µ –Ω–∞–π–¥–µ–Ω
```
‚ùå –ö–ª—é—á –Ω–µ –Ω–∞–π–¥–µ–Ω: sk-nonexistent
```
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ø–∏—Å–æ–∫ –∫–ª—é—á–µ–π –∫–æ–º–∞–Ω–¥–æ–π `list-keys`

### –û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª—É
```
‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–ª—é—á–µ–π: Permission denied
```
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `billing/`